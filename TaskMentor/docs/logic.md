# Логика работы TaskMentor (Business Logic)

Этот документ описывает нестандартные сценарии и правила сортировки, которые важны для понимания проекта и проверки.

---

## 1) Роли и доступ

В системе предусмотрены две роли:
- **Учитель** — управляет учениками и задачами, принимает заявки учеников.
- **Ученик** — выполняет назначенные задачи и работает в своём личном кабинете.

Важно: роли разделены на уровне доступа.
- **Учитель не может входить через интерфейс ученика**
- **Ученик не может входить через интерфейс учителя**

---

## 2) Регистрация и создание аккаунтов

### 2.1 Регистрация учителя
Учитель регистрируется стандартно:
- вводит **e-mail** и **пароль**
- поле “логин” отсутствует (идентификация идёт по e-mail)

### 2.2 Регистрация ученика (нестандартная логика)
Ученик **не создаёт аккаунт напрямую**.

Сценарий выглядит так:
1. Ученик заполняет форму заявки и **указывает e-mail своего учителя** (коуча), который уже зарегистрирован в системе.
2. Заявка отправляется учителю.
3. Учитель принимает (одобряет) заявку и **задаёт пароль для ученика**.
4. После одобрения ученик может войти в систему по **e-mail + пароль**.

---

## 3) Вход через Google (OAuth)

В проекте реализован **вход через Google**, но не “регистрация через Google”.

Правило:
- пользователь (учитель или ученик) должен быть **уже зарегистрирован в TaskMentor**
- при входе через Google используется выбранный Google-аккаунт
- если e-mail Google **не найден в базе TaskMentor**, вход не выполняется

---

## 4) Сортировки задач в ЛК ученика

В личном кабинете ученика предусмотрено 4 режима сортировки:

1) **По умолчанию (Рекомендуется)**  
2) **По дате**  
3) **По приоритету**  
4) **Ближайшие 24 часа**

### Зачем так устроено (педагогическая цель)
Сортировки “по дате” и “по приоритету” похожи и intentionally учитывают просроченные задачи так, чтобы:
- стимулировать ученика **выполнять задачи последовательно**
- минимизировать “перепрыгивание” через важные шаги
- учитывать приоритет, выставленный учителем (как экспертную оценку важности)

---

## 4.1 Сортировка “По умолчанию (Рекомендуется)”
Задачи делятся на две группы:
- **Просроченные**
- **Непросроченные**

### Просроченные задачи
Группировка по приоритету сверху вниз:
1. Высокий приоритет
2. Средний приоритет
3. Низкий приоритет

Внутри каждого приоритета:
- чем **больше дней просрочки**, тем **выше** задача

Важно: приоритет важнее количества дней просрочки  
(например, низкий приоритет с 100 днями просрочки будет ниже, чем высокий приоритет с 1 днём просрочки).

### Непросроченные задачи
Используется “вес” (критичность) задачи:

- Высокий = 3, Средний = 2, Низкий = 1
- Формула:
  Срочность = (значение приоритета) / (осталось дней до дедлайна + 1)
- Сортировка по убыванию срочности:
  чем выше приоритет и ближе дедлайн — тем выше задача.

---

## 4.2 Сортировка “По дате”
Задачи делятся на две группы:
- **Просроченные**
- **Непросроченные**

### Просроченные
Сначала “Высокие”, затем “Средние”, затем “Низкие”.  
Внутри каждой группы сортировка по дате исполнения:
- сверху задачи с **более поздней** датой исполнения (ближе к текущей),
- ниже — с более ранней.

### Непросроченные
Задачи сортируются по дате исполнения в логике “от ближайших к более дальним”
(сверху те, что наступают раньше).

---

## 4.3 Сортировка “По приоритету”
Задачи делятся на две группы:
- **Просроченные**
- **Непросроченные**

### Просроченные
Отображаются как в сортировке “По дате”:
- Высокие → Средние → Низкие
- внутри приоритета сверху задачи с более поздней датой исполнения (ближе к текущей)

### Непросроченные
Группировка по приоритету:
1. Высокий
2. Средний
3. Низкий

Внутри каждого приоритета — сортировка по дате исполнения:
- сверху более ближайшие даты (раньше),
- ниже — более дальние.

---

## 4.4 Фильтр “Ближайшие 24 часа”
Отображает только задачи, срок исполнения которых наступает **в ближайшие 24 часа**:
- просроченные задачи не включаются
- сортировка по возрастанию “времени наступления”:
  задачи, которые заканчиваются раньше — выше.
